<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>BlockRiser · DeeJay Labs</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@400;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/index.css">
    <link rel="stylesheet" href="/toy-box.css">
    <link rel="stylesheet" href="/adventure.css">
    <link rel="stylesheet" href="/boosters.css">
    <link rel="stylesheet" href="/mobile-fixes.css">
    <link rel="stylesheet" href="/world-backgrounds.css">
    <link rel="stylesheet" href="/button-fix.css">
    <link rel="stylesheet" href="/mascot.css">
    <link rel="manifest" href="/manifest.webmanifest">
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js');
            });
        }
    </script>
</head>

<body>

    <div id="splash-screen">
        <div class="splash-logo">BLOCK RISER</div>
        <div class="loader"></div>
    </div>

    <!-- Parallax Background -->
    <div class="city-parallax">
        <div class="city-layer layer-1"></div>
        <div class="city-layer layer-2"></div>
        <div class="city-layer layer-3"></div>
    </div>

    <div class="bg-overlay-gradient"></div>

    <header id="game-header" class="hidden">
        <div class="hud-group">
            <div class="hud-label">Score</div>
            <div id="hud-score" class="hud-value highlight">0</div>
        </div>
        <div class="hud-group">
            <div class="hud-label" id="hud-level-label">Level</div>
            <div id="hud-level" class="hud-value">1</div>
        </div>
        <div class="hud-group">
            <div class="hud-label">Best</div>
            <div id="hud-highscore" class="hud-value">0</div>
        </div>
        <div class="hud-group">
            <div class="hud-label">Gold</div>
            <div id="hud-coins" class="hud-value gold">0</div>
        </div>
        <div id="league-badge" class="hud-group league-bronze">
            <div class="hud-label">League</div>
            <div id="hud-league" class="hud-value">BRONZE</div>
        </div>
        <div id="policy-badge" class="hud-group" style="display:none">
            <div class="hud-label">Policy</div>
            <div id="hud-policy" class="hud-value" style="font-size:14px"></div>
            <div id="bailout-tokens" class="bailout-tokens"></div>
        </div>
    </header>

    <main id="game-container">
        <div id="bailout-sweep" class="bailout-sweep"></div>
        <div id="level-up-indicator" class="level-up-msg">LEVEL UP!</div>
        <div id="boss-ui" class="boss-bar hidden">
            <div class="boss-label">EPIC BOSS: <span id="boss-name">TOY MASTER</span></div>
            <div class="boss-health-wrap">
                <div id="boss-health" class="boss-health-fill"></div>
            </div>
        </div>
        <canvas id="gameCanvas" width="800" height="1200"></canvas>

        <div id="toast-instruction" class="toast">Drag pieces to the grid</div>

        <div id="powerup-ui" class="powerup-bar">
            <button id="btn-hammer" class="powerup-btn">
                <span class="powerup-icon">🔨</span>
                <span id="count-hammer" class="powerup-count">0</span>
            </button>
            <button id="btn-bomb" class="powerup-btn">
                <span class="powerup-icon">💣</span>
                <span id="count-bomb" class="powerup-count">0</span>
            </button>
            <button id="btn-reroll" class="powerup-btn">
                <span class="powerup-icon">🔄</span>
                <span id="count-reroll" class="powerup-count">0</span>
            </button>
            <button id="btn-undo" class="powerup-btn">
                <img src="/icon_undo.svg" class="shop-icon-img-small" alt="Undo">
                <span id="count-undo" class="powerup-count">0</span>
            </button>
            <div class="separator-vertical"></div>
            <button id="pause-btn" class="powerup-btn btn-dark">
                <span class="powerup-icon" style="font-size: 24px;">⏸</span>
            </button>
        </div>

        <!-- Nano Banana Mascot -->
        <div id="mascot-root" class="mascot-container hidden">
            <div id="mascot-bubble" class="speech-bubble">Hi! I'm Nano!</div>
            <div id="mascot-character" class="nano-banana">
                🍌
                <div class="mascot-visor"></div>
            </div>
        </div>
    </main>

    <!-- Overlay System -->

    <!-- Main Menu -->
    <div id="menu-overlay" class="overlay">
        <div class="bg-3d-scene" style="z-index: -1;">
            <div class="floating-shape shape-1"></div>
            <div class="floating-shape shape-2"></div>
            <div class="floating-shape shape-3"></div>
            <div class="floating-shape shape-4"></div>
            <div class="floating-shape shape-5"></div>
            <div class="floating-shape shape-6"></div>
        </div>
        <!-- Top Dashboard -->
        <div class="home-dashboard">
            <div class="dash-left">
                <button id="btn-settings" class="icon-btn-glass">⚙️</button>
                <button id="btn-themes" class="icon-btn-glass">🎨</button>
            </div>
            <div class="dash-center">
                <div id="menu-coin-display" class="coin-balance-display">0 🟡</div>
            </div>
            <div class="dash-right">
                <button id="btn-stats" class="icon-btn-glass">📊</button>
                <button id="btn-leaderboard" class="icon-btn-glass">🏆</button>
            </div>
        </div>

        <div class="overlay-content home-content">
            <div class="hero-section">
                <h1 class="logo-premium">BLOCK RISER</h1>
                <p class="subtitle shimmering">TOY EDITION</p>
            </div>

            <div class="action-stack">
                <button id="btn-play-menu" class="btn-premium btn-play">
                    <span class="btn-label">NEW GAME</span>
                </button>
                <button id="btn-resume" class="btn-premium btn-resume hidden">
                    <span class="btn-label">CONTINUE</span>
                </button>
                <button id="btn-tutorial" class="btn-premium btn-tutorial">
                    <span class="btn-label">HOW TO PLAY</span>
                </button>
            </div>

            <!-- Bottom Toy Bar -->
            <div class="tycoon-bar">
                <button id="btn-shop" class="tycoon-btn">
                    <span class="t-icon">🧸</span>
                    <span class="t-label">TOY SHOP</span>
                </button>
                <button id="btn-hq" class="tycoon-btn hq-active">
                    <span class="t-icon">🧩</span>
                    <span class="t-label">TOY BOX</span>
                </button>
                <button id="btn-world" class="tycoon-btn">
                    <span class="t-icon">🗺️</span>
                    <span class="t-label">WORLDS</span>
                </button>
            </div>
            <div class="brand-footer-premium">DeeJay Labs</div>
        </div>
    </div>

    <!-- HQ Overlay -->
    <div id="hq-overlay" class="overlay hidden">
        <div class="overlay-content">
            <h2 class="title-large">TOY BOX</h2>
            <div class="glass-panel" style="width:100%; text-align:center; padding:15px">
                <div id="hq-status" style="font-size:14px; opacity:0.8; margin-bottom:10px">Status: Starter Set
                </div>
                <div id="hq-income" style="font-size:18px; font-weight:900; color:var(--gold-color)">50 🟡 / HR
                </div>
            </div>
            <div id="hq-upgrades" class="shop-grid" style="margin-top:10px"></div>

            <h3 style="margin-top:20px; font-size:16px; letter-spacing:1px">COLLECTION</h3>
            <div id="acquisitions-gallery" class="shop-grid"
                style="margin-top:5px; grid-template-columns: repeat(5, 1fr); gap: 5px;"></div>

            <button id="btn-close-hq" class="btn-secondary" style="margin-top:10px">Back</button>
        </div>
    </div>

    <!-- World Map Overlay -->
    <div id="world-overlay" class="overlay hidden">
        <div class="overlay-content">
            <h2 class="title-large">WORLD MAP</h2>
            <div id="city-list" class="adventure-map" style="margin-top:10px"></div>
            <button id="btn-close-world" class="btn-secondary" style="margin-top:10px">Back</button>
        </div>
    </div>

    <!-- Mode Selection -->
    <div id="mode-overlay" class="overlay hidden">
        <div class="overlay-content" style="max-width: 400px;">
            <h2 class="title-large">SELECT MODE</h2>
            <p class="subtitle shimmering" style="margin-bottom: 25px;">PICK YOUR PLAYSTYLE</p>

            <div class="menu-stack" style="gap: 12px;">
                <button id="btn-mode-classic" class="btn-premium btn-play mode-card">
                    <div class="mode-icon-wrap">📊</div>
                    <div class="mode-info">
                        <span class="btn-label">CLASSIC</span>
                        <span class="btn-subtext">Original High-Score Dash</span>
                    </div>
                </button>

                <button id="btn-mode-adventure" class="btn-premium btn-adventure mode-card">
                    <div class="mode-icon-wrap">🗺️</div>
                    <div class="mode-info">
                        <span class="btn-label">ADVENTURE</span>
                        <span class="btn-subtext">Explore Toy Worlds</span>
                    </div>
                </button>

                <button id="btn-mode-bomb" class="btn-premium btn-red mode-card">
                    <div class="mode-icon-wrap">💣</div>
                    <div class="mode-info">
                        <span class="btn-label">BOMB RUSH</span>
                        <span class="btn-subtext">Beat the Clock!</span>
                    </div>
                </button>

                <button id="btn-mode-zen" class="btn-premium btn-purple mode-card">
                    <div class="mode-icon-wrap">🌸</div>
                    <div class="mode-info">
                        <span class="btn-label">ZEN MODE</span>
                        <span class="btn-subtext">Relaxing Endless Flow</span>
                    </div>
                </button>

                <button id="btn-mode-back" class="btn-secondary"
                    style="margin-top: 15px; width: 100%; height: 50px;">Back to Toy Box</button>
            </div>
        </div>
    </div>
    <!-- Policy Selection -->
    <div id="policy-overlay" class="overlay hidden">
        <div class="overlay-content">
            <h2 class="title-large">BOOSTERS</h2>
            <p class="subtitle" style="margin-bottom:10px">CHOOSE YOUR POWER UP</p>
            <div id="policy-list" class="booster-grid" style="width:100%"></div>
            <button id="btn-policy-skip" class="btn-secondary" style="margin-top:10px">Skip Power</button>

            <div class="brand-footer">
                <span class="brand-logo-text">DeeJay Labs</span>
            </div>
        </div>
    </div>

    <!-- Adventure Map -->
    <div id="adventure-overlay" class="overlay hidden">
        <div class="overlay-content">
            <h2 class="title-large">ADVENTURE</h2>
            <div id="adventure-list" class="adventure-map"></div>
            <button id="btn-adventure-back" class="btn-secondary">Back</button>
        </div>
    </div>

    <!-- Shop -->
    <div id="shop-overlay" class="overlay hidden">
        <div class="overlay-content">
            <h2 class="title-large">TOY SHOP</h2>
            <div id="shop-coin-display" class="coin-balance-display" style="margin-bottom:10px">0 🟡</div>
            <div id="shop-container" class="shop-grid">
                <div class="shop-item" onclick="buyItem('hammer', 200)">
                    <img src="/icon_hammer.svg" class="shop-icon-img" alt="Hammer">
                    <div class="shop-name">Hammer</div>
                    <div class="shop-desc">Remove 1 block</div>
                    <div class="shop-price">200 🟡</div>
                </div>
                <div class="shop-item" onclick="buyItem('bomb', 500)">
                    <img src="/icon_tnt.svg" class="shop-icon-img" alt="TNT">
                    <div class="shop-name">TNT</div>
                    <div class="shop-desc">3x3 Blast!</div>
                    <div class="shop-price">500 🟡</div>
                </div>
                <div class="shop-item" onclick="buyItem('reroll', 150)">
                    <img src="/icon_reroll.svg" class="shop-icon-img" alt="Reroll">
                    <div class="shop-name">Reroll</div>
                    <div class="shop-desc">Get new pieces</div>
                    <div class="shop-price">150 🟡</div>
                </div>
                <div class="shop-item" onclick="buyItem('undo', 300)">
                    <img src="/icon_undo.svg" class="shop-icon-img" alt="Undo">
                    <div class="shop-name">Undo</div>
                    <div class="shop-desc">Undo last move</div>
                    <div class="shop-price">300 🟡</div>
                </div>
            </div>
            <div id="policy-shop" class="shop-grid" style="margin-top:10px"></div>
            <button id="btn-close-shop" class="btn-secondary" style="margin-top:15px; width: 100%;">Close</button>
        </div>
    </div>

    <!-- Daily Rewards -->
    <div id="daily-overlay" class="overlay hidden">
        <div class="overlay-content">
            <h2 class="title-large">DAILY BONUS</h2>
            <p class="subtitle">COLLECT YOUR REWARD</p>
            <div id="daily-grid" class="daily-grid"></div>
            <button id="btn-claim-daily" class="btn-3d btn-green">Claim Now!</button>
        </div>
    </div>

    <!-- Pause Menu -->
    <div id="pause-overlay" class="overlay hidden">
        <div class="overlay-content">
            <h2 class="title-large">PAUSED</h2>
            <p class="subtitle shimmering">GAME ON HOLD</p>
            <div class="menu-stack" style="margin-top:20px; width: 80%">
                <button id="btn-pause-resume" class="btn-premium btn-play">
                    <span class="btn-label">RESUME GAME</span>
                </button>
                <button id="btn-pause-quit" class="btn-premium btn-red">
                    <span class="btn-label">QUIT GAME</span>
                </button>
            </div>
            <div class="pause-brand">
                <div class="brand-footer-premium">DEVELOPED BY</div>
                <div class="deejay-logo-pause">DeeJay Labs</div>
            </div>
        </div>
    </div>

    <!-- Game Over Overlay -->
    <div id="gameover-overlay" class="overlay hidden">
        <div class="overlay-content">
            <h2 class="title-large">GAME OVER</h2>
            <div class="score-display" id="final-score">0</div>
            <div style="font-size:14px; opacity:0.6; margin-bottom:20px">BEST: <span id="final-highscore">0</span></div>
            <button id="btn-restart" class="btn-3d btn-blue">Play Again</button>
            <button id="btn-home" class="btn-secondary">Main Menu</button>
        </div>
    </div>

    <!-- High Score Input -->
    <div id="input-overlay" class="overlay hidden">
        <div class="overlay-content">
            <h2 class="title-large">NEW RECORD!</h2>
            <div class="score-display" id="input-score">0</div>
            <input type="text" id="initials-input" class="initials-input" maxlength="3" placeholder="AAA">
            <button id="btn-submit-score" class="btn-3d btn-green" style="margin-top:10px">Save Record</button>
        </div>
    </div>

    <!-- Leaderboard -->
    <div id="leaderboard-overlay" class="overlay hidden">
        <div class="overlay-content">
            <h2 class="title-large">LEADERBOARD</h2>
            <div class="tab-container" style="display:flex; gap:10px; margin-bottom:15px; width:100%">
                <button id="btn-tab-local" class="tab-btn active" style="flex:1">LOCAL</button>
                <button id="btn-tab-global" class="tab-btn" style="flex:1">GLOBAL</button>
            </div>
            <div id="leaderboard-list" class="glass-panel"
                style="width:100%; margin-top:0px; padding:0; max-height: 300px; overflow-y: auto;"></div>
            <button id="btn-close-leaderboard" class="btn-secondary" style="margin-top:15px; width:100%">Close</button>
        </div>
    </div>

    <!-- YOUR STATS -->
    <div id="stats-overlay" class="overlay hidden">
        <div class="overlay-content stats-panel-scroll">
            <h2 class="title-large pulsate">YOUR STATS</h2>
            <div id="stats-grid" class="stats-container"></div>

            <div class="section-divider">
                <span class="divider-text">UPGRADE TREE</span>
            </div>
            <div id="upgrades-list" class="shop-grid"></div>

            <div class="section-divider">
                <span class="divider-text">ACHIEVEMENTS</span>
            </div>
            <div id="achievements-grid" class="achievements-list"></div>

            <button id="btn-close-stats" class="btn-premium btn-play" style="margin-top:20px; width:100%">
                <span class="btn-label">BACK TO MENU</span>
            </button>
        </div>
    </div>

    <!-- Themes -->
    <div id="themes-overlay" class="overlay hidden">
        <div class="overlay-content">
            <h2 class="title-large">THEMES</h2>
            <div id="theme-grid" class="grid-select" style="margin-top:10px"></div>

            <h3 style="margin-top:20px; font-size:16px; letter-spacing:1px">BLOCK SKINS</h3>
            <div id="skin-grid" class="grid-select" style="margin-top:10px; grid-template-columns: repeat(2, 1fr);">
                <button class="btn-premium skin-btn" onclick="setSkin('default')">DEFAULT</button>
                <button class="btn-premium skin-btn" onclick="setSkin('crystal')"
                    style="background: linear-gradient(135deg, #81D4FA, #0288D1);">CRYSTAL</button>
                <button class="btn-premium skin-btn" onclick="setSkin('neon')"
                    style="background: #000; border: 2px solid #00f2ff; color: #00f2ff;">NEON</button>
                <button class="btn-premium skin-btn" onclick="setSkin('wood')"
                    style="background: #8D6E63;">WOOD</button>
            </div>

            <button id="btn-close-themes" class="btn-secondary" style="margin-top:20px">Close</button>
        </div>
    </div>

    <!-- How to Play -->
    <div id="tutorial-overlay" class="overlay hidden">
        <div class="overlay-content" style="max-width: 450px;">
            <h2 class="title-large shimmering">HOW TO PLAY</h2>
            <div class="glass-panel"
                style="width:100%; margin-top:10px; text-align: left; font-size: 14px; line-height: 1.6; padding: 20px;">
                <p>📊 <b>Drag & Drop:</b> Move blocks from your queue to the grid. Fill rows or columns to clear them
                    and
                    earn points!</p>
                <p>🔥 <b>Combo Strategy:</b> Clear multiple lines at once to build <b>Combo Heat</b> for massive
                    multipliers.</p>
                <p>🛠️ <b>Power-Ups:</b> Use Hammers to remove single blocks or TNT to clear 3x3 areas. Reroll the queue
                    if you're stuck.</p>
                <p>⚔️ <b>Boss Fights:</b> In Adventure mode, clear blocks to damage bosses and unlock their
                    treasures!</p>
            </div>
            <button id="btn-close-tutorial" class="btn-premium btn-play" style="margin-top:20px; width: 100%;">
                <span class="btn-label">GOT IT!</span>
            </button>
        </div>
    </div>

    <!-- Settings -->
    <div id="settings-overlay" class="overlay hidden">
        <div class="overlay-content">
            <h2 class="title-large">SETTINGS</h2>
            <div class="glass-panel" style="width:100%; margin-top:20px">
                <div class="settings-row">
                    <span>Speed</span>
                    <button id="btn-speed-toggle" class="btn-toggle">NORM</button>
                </div>
                <div class="settings-row">
                    <span>Music</span>
                    <button id="btn-music-toggle" class="btn-toggle on">ON</button>
                </div>
                <div class="settings-row">
                    <span>SFX</span>
                    <button id="btn-sfx-toggle" class="btn-toggle on">ON</button>
                </div>
                <div class="settings-row">
                    <span>Graphics</span>
                    <button id="btn-gfx-toggle" class="btn-toggle on">HIGH</button>
                </div>
                <div class="settings-row">
                    <span>Vibration</span>
                    <button id="btn-vib-toggle" class="btn-toggle on">ON</button>
                </div>
            </div>
            <button id="btn-reset-data" class="btn-premium btn-adventure"
                style="margin-top:20px; width:100%; border-bottom-color: #c62828 !important; background: #ef5350 !important;">
                <span class="btn-label">RESET ALL DATA</span>
            </button>
            <button id="btn-close-settings" class="btn-premium btn-play" style="margin-top:10px; width:100%">
                <span class="btn-label">CLOSE</span>
            </button>
        </div>
    </div>

    <footer class="main-footer">DeeJay Labs</footer>

    <script type="module" src="/index.tsx"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js');
        }
        window.addEventListener('load', () => {
            const splash = document.getElementById('splash-screen');
            setTimeout(() => {
                splash.style.opacity = '0';
                setTimeout(() => splash.remove(), 500);
            }, 1000);
        });
    </script>
</body>

</html>