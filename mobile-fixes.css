/* === COMPREHENSIVE SMARTPHONE OPTIMIZATIONS === */

/* Prevent text selection during gameplay */
body {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
    /* Prevents double-tap zoom */
}

/* Smooth scrolling for overlays */
.overlay-content {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
}

/* Hardware acceleration for animations */
.theme-box,
.tycoon-btn,
.btn-premium,
.powerup-btn {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    will-change: transform;
}

/* Safe area padding for notched devices */
body {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
}

/* Ensure canvas is touch-responsive */
#gameCanvas {
    touch-action: none;
    -webkit-touch-callout: none;
}

@media (max-width: 480px) {
    header {
        padding: 5px 10px;
        gap: 5px;
    }

    .hud-group {
        min-width: auto;
        padding: 4px 6px;
        flex: 1;
    }

    .hud-label {
        font-size: 8px;
        letter-spacing: 0;
    }

    .hud-value {
        font-size: 14px;
    }

    /* Hide less critical items on very small screens */
    #hud-highscore {
        display: none;
    }

    #hud-highscore+.hud-label {
        display: none;
    }

    .hud-group:has(#hud-highscore) {
        display: none;
    }

    /* Touch-friendly button sizes (minimum 44px) */
    button.icon-btn {
        width: 44px !important;
        height: 44px !important;
        font-size: 18px;
    }

    .powerup-bar {
        bottom: 10px;
        padding: 6px 8px;
        gap: 6px;
    }

    .powerup-btn {
        min-width: 48px !important;
        height: 48px !important;
    }

    .powerup-icon {
        font-size: 18px;
    }

    /* Ensure all interactive elements are touch-friendly */
    .tycoon-btn {
        min-width: 80px !important;
        min-height: 80px !important;
        width: 80px !important;
        height: 80px !important;
    }

    /* Optimize overlay sizes for small screens */
    .overlay-content {
        max-width: 95vw !important;
        max-height: 90vh !important;
        padding: 30px 20px 80px 20px !important;
    }

    /* Reduce logo size on very small screens */
    .logo-premium {
        font-size: 36px !important;
        margin-bottom: 10px !important;
    }

    /* Compact menu buttons */
    .btn-premium {
        padding: 12px 20px !important;
        font-size: 14px !important;
        min-height: 50px !important;
    }

    /* Optimize theme grid for mobile */
    #theme-grid {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 10px !important;
    }

    .theme-box {
        min-height: 120px !important;
    }
}

/* Extra small devices (< 360px) */
@media (max-width: 360px) {
    .logo-premium {
        font-size: 32px !important;
    }

    .btn-premium {
        font-size: 12px !important;
        padding: 10px 15px !important;
    }

    .tycoon-bar {
        gap: 8px !important;
        padding: 8px 12px !important;
    }

    .tycoon-btn {
        width: 80px !important;
        height: 80px !important;
    }

    .t-icon {
        font-size: 28px !important;
    }

    .t-label {
        font-size: 11px !important;
    }
}

/* === OVERLAY FIXES FOR ALL MODALS === */
.overlay {
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
}

.overlay-content {
    max-width: 90vw !important;
    max-height: 90vh !important;
    width: auto !important;
    padding: 30px 20px 80px 20px !important;
    box-sizing: border-box !important;
    overflow-y: auto !important;
    display: flex !important;
    flex-direction: column !important;
}

/* Ensure all close buttons are visible */
.overlay-content button[id^="btn-close"],
.overlay-content .btn-secondary {
    margin-top: 20px !important;
    margin-bottom: 0 !important;
    flex-shrink: 0 !important;
    align-self: center !important;
}

/* Fix shop grid to prevent overflow */
.shop-grid {
    display: grid !important;
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 10px !important;
    width: 100% !important;
    max-width: 100% !important;
    overflow: visible !important;
}